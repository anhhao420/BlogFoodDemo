{"ast":null,"code":"import _regeneratorRuntime from\"D:/CNPM/NodeJS/TaiLieu/youtube-mern-blog-app/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"D:/CNPM/NodeJS/TaiLieu/youtube-mern-blog-app/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"D:/CNPM/NodeJS/TaiLieu/youtube-mern-blog-app/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import axios from\"axios\";import{useContext,useEffect,useState}from\"react\";import{useLocation}from\"react-router\";import{Link}from\"react-router-dom\";import{Context}from\"../../context/Context\";import\"./singlePost.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function SinglePost(){var location=useLocation();var path=location.pathname.split(\"/\")[2];var _useState=useState({}),_useState2=_slicedToArray(_useState,2),post=_useState2[0],setPost=_useState2[1];var PF=\"http://localhost:5000/images/\";var _useContext=useContext(Context),user=_useContext.user;var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),title=_useState4[0],setTitle=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),desc=_useState6[0],setDesc=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),updateMode=_useState8[0],setUpdateMode=_useState8[1];useEffect(function(){var getPost=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(\"/posts/\"+path);case 2:res=_context.sent;setPost(res.data);setTitle(res.data.title);setDesc(res.data.desc);case 6:case\"end\":return _context.stop();}},_callee);}));return function getPost(){return _ref.apply(this,arguments);};}();getPost();},[path]);var handleDelete=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axios.delete(\"/posts/\".concat(post._id),{data:{username:user.username}});case 3:window.location.replace(\"/\");_context2.next=8;break;case 6:_context2.prev=6;_context2.t0=_context2[\"catch\"](0);case 8:case\"end\":return _context2.stop();}},_callee2,null,[[0,6]]);}));return function handleDelete(){return _ref2.apply(this,arguments);};}();var handleUpdate=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return axios.put(\"/posts/\".concat(post._id),{username:user.username,title:title,desc:desc});case 3:setUpdateMode(false);_context3.next=8;break;case 6:_context3.prev=6;_context3.t0=_context3[\"catch\"](0);case 8:case\"end\":return _context3.stop();}},_callee3,null,[[0,6]]);}));return function handleUpdate(){return _ref3.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{className:\"singlePost\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"singlePostWrapper\",children:[post.photo&&/*#__PURE__*/_jsx(\"img\",{src:PF+post.photo,alt:\"\",className:\"singlePostImg\"}),updateMode?/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:title,className:\"singlePostTitleInput\",autoFocus:true,onChange:function onChange(e){return setTitle(e.target.value);}}):/*#__PURE__*/_jsxs(\"h1\",{className:\"singlePostTitle\",children:[title,post.username===(user===null||user===void 0?void 0:user.username)&&/*#__PURE__*/_jsxs(\"div\",{className:\"singlePostEdit\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"singlePostIcon far fa-edit\",onClick:function onClick(){return setUpdateMode(true);}}),/*#__PURE__*/_jsx(\"i\",{className:\"singlePostIcon far fa-trash-alt\",onClick:handleDelete})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"singlePostInfo\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"singlePostAuthor\",children:[\"Author:\",/*#__PURE__*/_jsx(Link,{to:\"/?user=\".concat(post.username),className:\"link\",children:/*#__PURE__*/_jsxs(\"b\",{children:[\" \",post.username]})})]}),/*#__PURE__*/_jsx(\"span\",{className:\"singlePostDate\",children:new Date(post.createdAt).toDateString()})]}),updateMode?/*#__PURE__*/_jsx(\"textarea\",{className:\"singlePostDescInput\",value:desc,onChange:function onChange(e){return setDesc(e.target.value);}}):/*#__PURE__*/_jsx(\"p\",{className:\"singlePostDesc\",children:desc}),updateMode&&/*#__PURE__*/_jsx(\"button\",{className:\"singlePostButton\",onClick:handleUpdate,children:\"Update\"})]})});}","map":{"version":3,"names":["axios","useContext","useEffect","useState","useLocation","Link","Context","jsx","_jsx","jsxs","_jsxs","SinglePost","location","path","pathname","split","_useState","_useState2","_slicedToArray","post","setPost","PF","_useContext","user","_useState3","_useState4","title","setTitle","_useState5","_useState6","desc","setDesc","_useState7","_useState8","updateMode","setUpdateMode","getPost","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","res","wrap","_callee$","_context","prev","next","get","sent","data","stop","apply","arguments","handleDelete","_ref2","_callee2","_callee2$","_context2","delete","concat","_id","username","window","replace","t0","handleUpdate","_ref3","_callee3","_callee3$","_context3","put","className","children","photo","src","alt","type","value","autoFocus","onChange","e","target","onClick","to","Date","createdAt","toDateString"],"sources":["D:/CNPM/NodeJS/TaiLieu/youtube-mern-blog-app/client/src/components/singlePost/SinglePost.jsx"],"sourcesContent":["import axios from \"axios\";\nimport { useContext, useEffect, useState } from \"react\";\nimport { useLocation } from \"react-router\";\nimport { Link } from \"react-router-dom\";\nimport { Context } from \"../../context/Context\";\nimport \"./singlePost.css\";\n\nexport default function SinglePost() {\n  const location = useLocation();\n  const path = location.pathname.split(\"/\")[2];\n  const [post, setPost] = useState({});\n  const PF = \"http://localhost:5000/images/\";\n  const { user } = useContext(Context);\n  const [title, setTitle] = useState(\"\");\n  const [desc, setDesc] = useState(\"\");\n  const [updateMode, setUpdateMode] = useState(false);\n\n  useEffect(() => {\n    const getPost = async () => {\n      const res = await axios.get(\"/posts/\" + path);\n      setPost(res.data);\n      setTitle(res.data.title);\n      setDesc(res.data.desc);\n    };\n    getPost();\n  }, [path]);\n\n  const handleDelete = async () => {\n    try {\n      await axios.delete(`/posts/${post._id}`, {\n        data: { username: user.username },\n      });\n      window.location.replace(\"/\");\n    } catch (err) {}\n  };\n\n  const handleUpdate = async () => {\n    try {\n      await axios.put(`/posts/${post._id}`, {\n        username: user.username,\n        title,\n        desc,\n      });\n      setUpdateMode(false)\n    } catch (err) {}\n  };\n\n  return (\n    <div className=\"singlePost\">\n      <div className=\"singlePostWrapper\">\n        {post.photo && (\n          <img src={PF + post.photo} alt=\"\" className=\"singlePostImg\" />\n        )}\n        {updateMode ? (\n          <input\n            type=\"text\"\n            value={title}\n            className=\"singlePostTitleInput\"\n            autoFocus\n            onChange={(e) => setTitle(e.target.value)}\n          />\n        ) : (\n          <h1 className=\"singlePostTitle\">\n            {title}\n            {post.username === user?.username && (\n              <div className=\"singlePostEdit\">\n                <i\n                  className=\"singlePostIcon far fa-edit\"\n                  onClick={() => setUpdateMode(true)}\n                ></i>\n                <i\n                  className=\"singlePostIcon far fa-trash-alt\"\n                  onClick={handleDelete}\n                ></i>\n              </div>\n            )}\n          </h1>\n        )}\n        <div className=\"singlePostInfo\">\n          <span className=\"singlePostAuthor\">\n            Author:\n            <Link to={`/?user=${post.username}`} className=\"link\">\n              <b> {post.username}</b>\n            </Link>\n          </span>\n          <span className=\"singlePostDate\">\n            {new Date(post.createdAt).toDateString()}\n          </span>\n        </div>\n        {updateMode ? (\n          <textarea\n            className=\"singlePostDescInput\"\n            value={desc}\n            onChange={(e) => setDesc(e.target.value)}\n          />\n        ) : (\n          <p className=\"singlePostDesc\">{desc}</p>\n        )}\n        {updateMode && (\n          <button className=\"singlePostButton\" onClick={handleUpdate}>\n            Update\n          </button>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}